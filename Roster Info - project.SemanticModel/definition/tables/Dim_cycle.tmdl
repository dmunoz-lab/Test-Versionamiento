table Dim_cycle
	lineageTag: e6d0c531-556c-4fe5-aa17-f3d88c94676b

	column Cycle
		dataType: string
		lineageTag: 009befc0-fabc-4c54-a830-15f311bf2285
		summarizeBy: none
		sourceColumn: Cycle

		annotation SummarizationSetBy = Automatic

	partition Dim_cycle = m
		mode: import
		queryGroup: Roster
		source = ```
				let
				    Source = Excel.Workbook(Web.Contents("https://perfilesysoluciones.sharepoint.com/sites/CROSSFUNCTIONALREPORTINGTEAM/Shared%20Documents/Seat%20Count%20Report/COGs/Roster%20Historical%202024.xlsx"), null, true),
				    July1524_Table = Source{[Item="roster_historical",Kind="Table"]}[Data],
				
				    // Combinar con 2025
				    #"Appended Query" = Table.Combine({July1524_Table, roster_historical2025}),
				
				    // Tipos de datos
				    #"Changed Type1" = Table.TransformColumnTypes(#"Appended Query",{
				        {"Roster date", type date}, {"Branch", type text}, {"Office", type text}, {"Residence", type text}, 
				        {"Service Line", type text}, {"Business Unit", type text}, {"company_id", Int64.Type}, {"Account", type text}, 
				        {"company_legal_name", type text}, {"Sub Account", type text}, {"Cost Center", type text}, {"Employee Name", type text}, 
				        {"ID Number", type any}, {"ID Type", type text}, {"Status", type text}, {"Substatus", type text}, 
				        {"Last Status Date", type date}, {"Active Date", type date}, {"Availability", type text}, {"Senior managers", type text}, 
				        {"OPS managers", type text}, {"Account Position", type text}, {"Internal Position", type any}, {"Department", type text}, 
				        {"Area", type text}, {"assigned_date", type any}, {"Direct", type text}, {"Birthday", type date}, 
				        {"Temporal Entry Date", type date}, {"Entry Date", type date}, {"Last Status Date2", type date}, 
				        {"Requisition", type text}, {"Salary Cost", Currency.Type}, {"Billrate", Currency.Type}, 
				        {"roster_vs_invoice_ID", Int64.Type}, {"service_line", type text}, {"Industry", type text}, {"Segmentation_ID", Int64.Type}
				    }),
				
				    // Duplico columna status original
				    #"Renamed Columns" = Table.RenameColumns(#"Changed Type1",{{"Status", "Status1"}}),
				    #"Capitalized Each Word" = Table.TransformColumns(#"Renamed Columns",{{"Status1", Text.Proper, type text}, {"Substatus", Text.Proper, type text}}),
				
				    // Agrego columna ciclo (15th o 30th)
				    #"Added Custom" = Table.AddColumn(#"Capitalized Each Word", "Cycle", each if Date.Day([Roster date])=15 then "15th" else "30th"),
				
				    // Reemplazos de valores
				    #"Replaced Value" = Table.ReplaceValue(#"Added Custom","Medical Case","Not Available",Replacer.ReplaceText,{"Status1"}),
				    #"Replaced Value1" = Table.ReplaceValue(#"Replaced Value","Deactivated","Not Available",Replacer.ReplaceText,{"Status1"}),
				    #"Replaced Value2" = Table.ReplaceValue(#"Replaced Value1","Training","Trainee",Replacer.ReplaceText,{"Substatus"}),
				
				    // üö® Correcci√≥n aqu√≠: Substatus vac√≠o ("") conserva Status1
				    #"Added Conditional Column" = Table.AddColumn(#"Replaced Value2", "Status", each 
				        if [Substatus] = null or [Substatus] = "" then [Status1] 
				        else if [Substatus] = "Floater" then [Status1] 
				        else if [Status1] = "Offboarding" then [Status1] 
				        else [Substatus]),
				
				    // Normalizo texto en otras columnas
				    #"Capitalized Each Word1" = Table.TransformColumns(#"Added Conditional Column",{
				        {"Branch", Text.Proper, type text}, {"Residence", Text.Proper, type text}, {"Office", Text.Proper, type text}, 
				        {"Service Line", Text.Proper, type text}, {"Business Unit", Text.Proper, type text}, {"Account", Text.Proper, type text}
				    }),
				
				    // Agrego pa√≠s por branch
				    #"Added Conditional Column1" = Table.AddColumn(#"Capitalized Each Word1", "Country", each 
				        if [Branch] = "Bogota" then "Colombia" 
				        else if [Branch] = "Medellin" then "Colombia" 
				        else if [Branch] = "Bucaramanga" then "Colombia" 
				        else if [Branch] = "Cartagena" then "Colombia" 
				        else if [Branch] = "Barranquilla" then "Colombia" 
				        else if [Branch] = "Cali" then "Colombia" 
				        else if [Branch] = "Manila" then "Philippines" 
				        else if [Branch] = "Ciudad De Guatemala" then "Guatemala" 
				        else if [Branch] = "Ciudad De Mexico" then "Mexico" 
				        else null),
				
				    // Limpieza de service line
				    #"Replaced Value3" = Table.ReplaceValue(#"Added Conditional Column1","Domestic","Delivery",Replacer.ReplaceText,{"Service Line"}),
				    #"Replaced Value4" = Table.ReplaceValue(#"Replaced Value3","Carrier Sales","Delivery",Replacer.ReplaceText,{"Service Line"}),
				
				    // Filtro internos
				    #"Filtered Rows" = Table.SelectRows(#"Replaced Value4", each ([Service Line] <> "Internal")),
				
				    // Renombrados y ajustes
				    #"Renamed Columns1" = Table.RenameColumns(#"Filtered Rows",{{"Service Line", "Previous Service Line"}}),
				    #"Replaced Value5" = Table.ReplaceValue(#"Renamed Columns1","Lean Bpo","Lean Operations",Replacer.ReplaceText,{"Business Unit"}),
				    #"Renamed Columns2" = Table.RenameColumns(#"Replaced Value5",{{"service_line", "Service Line"}}),
				
				    // Limpieza
				    #"Removed Columns" = Table.RemoveColumns(#"Renamed Columns2",{"Status1", "Substatus"}),
				    #"Filtered Rows1" = Table.SelectRows(#"Removed Columns", each ([Status] <> null)),
				
				    // Divisi√≥n
				    #"Added Conditional Column2" = Table.AddColumn(#"Filtered Rows1", "Division", each 
				        if [Status] = "Free Floater" then "Bench" 
				        else if [Status] = "Assigned" then "Bench" 
				        else if [Service Line] = "SMB" then "SMB" 
				        else if [Service Line] = "Enterprise" then "Enterprise" 
				        else if [Service Line] = "Marketing" then "Marketing" 
				        else if [Status] = "Profiled" then "Bench" 
				        else if [Status] = "Available" then "Bench" 
				        else if [Status] = "Not Available" then "Bench" 
				        else if [Status] = "Trainee" then "Bench" 
				        else if [Status] = "Offboarding" then "Bench" 
				        else if [Industry] = "Gf" then "Gf" 
				        else if [Industry] = "Bpo" then "Bpo" 
				        else if [Industry] = "Domestic" then "Domestic" 
				        else "NA"),
				
				    #"Filtered Rows2" = Table.SelectRows(#"Added Conditional Column2", each true),
				    #"Removed Other Columns" = Table.SelectColumns(#"Filtered Rows2",{"Cycle"}),
				    #"Removed Duplicates" = Table.Distinct(#"Removed Other Columns")
				in
				    #"Removed Duplicates"
				```

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

